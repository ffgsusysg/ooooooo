<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title> اديسون</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="https://cdn.glitch.global/c07dc79d-c056-48b0-8b0b-912783754321/5424770778815132543.jpg?v=1751739020203">
    
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
        <link rel="stylesheet" href="https://cdn.plyr.io/3.7.2/plyr.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.2.8/es6-promise.auto.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fetch/3.6.2/fetch.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
        <script src="https://cdn.plyr.io/3.7.2/plyr.polyfilled.js"></script>
    
    <style>
        /* CSS Variables for a more vibrant and smooth theme */
        :root {
            --primary-1: #3b82f6;
            --primary-2: #2563eb;
            --primary-3: #1d4ed8;
            --accent: #facc15;
            --accent-2: #eab308;
            --radius: 14px;
            --bg: #f8fafc;
            --bg-glass: rgba(255, 255, 255, 0.95);
            --text: #1f2937;
            --card: #ffffff;
            --border: #e2e8f0;
            --hover: rgba(0, 0, 0, 0.06);
            --success: #22c55e;
            --warning: #facc15;
            --error: #ef4444;
            --telegram-blue: #0088cc;
            --telegram-light: #2aabee;
            --telegram-text: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --plyr-color-main: var(--primary-1);


            /* Modal colors */
            --modal-bg-start: #6a11cb;
            --modal-bg-end: #2575fc;
            --modal-text-color: #ffffff;
            --modal-button-gradient-start: #00c6ff;
            --modal-button-gradient-end: #0072ff;
            --modal-button-text: #ffffff;
            --modal-outline-button-border: #ffffff;
            --modal-outline-button-text: #ffffff;

            /* Continue watching modal colors */
            --continue-modal-bg-start: #4facfe;
            --continue-modal-bg-end: #00f2fe;
            --continue-modal-text: #ffffff;
            --continue-button-bg: #00c896;
            --continue-button-hover: #00a87a;
            --continue-outline-button-border: #00c896;
            --continue-outline-button-text: #00c896;
            --highlight-color: #ffeb3b;
            --highlight-shadow: 0 0 8px rgba(255, 235, 59, 0.6);
        }

        /* Dark theme adjustments */
        [data-theme="dark"] {
            --bg: #1e293b;
            --bg-glass: rgba(30, 41, 59, 0.95);
            --text: #f1f5f9;
            --card: #334155;
            --border: #475569;
            --hover: rgba(255, 255, 255, 0.1);
            --primary-1: #60a5fa;
            --primary-2: #3b82f6;
            --primary-3: #2563eb;
            --accent: #fcd34d;
            --accent-2: #fbbf24;
            --plyr-color-main: var(--primary-1);


            /* Dark theme modal colors */
            --modal-bg-start: #1a2a6c;
            --modal-bg-end: #004d99;
            --modal-text-color: #e0e7ff;
            --modal-button-gradient-start: #007bff;
            --modal-button-gradient-end: #0056b3;
            --modal-button-text: #ffffff;
            --modal-outline-button-border: #9ec5ff;
            --modal-outline-button-text: #9ec5ff;

            /* Dark theme continue watching modal colors */
            --continue-modal-bg-start: #004d99;
            --continue-modal-bg-end: #1a2a6c;
            --continue-modal-text: #e0e7ff;
            --continue-button-bg: #007a5e;
            --continue-button-hover: #005a41;
            --continue-outline-button-border: #007a5e;
            --continue-outline-button-text: #007a5e;
        }

        /* General styles */
        *,
        *:before,
        *:after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Almarai', 'Tajawal', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-y: auto;
            transition: background 0.3s ease, color 0.3s ease;
        }

        img {
            max-width: 100%;
            display: block;
        }

        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            background: none;
        }

        /* Header styles */
        header {
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.6rem;
            background: var(--bg-glass);
            backdrop-filter: blur(14px);
            border-bottom: 1px solid var(--border);
            box-shadow: var(--shadow-md);
            flex-wrap: wrap;
            transition: background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .site-title {
            font-size: clamp(1.5rem, 5vw, 2rem);
            font-weight: 700;
            color: var(--primary-1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
            min-width: 200px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .site-logo {
            width: 40px;
            height: 40px;
            background: var(--primary-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: var(--shadow-sm);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .search-container {
            flex: 1;
            max-width: 650px;
            display: flex;
            gap: 0.5rem;
            position: relative;
            min-width: 250px;
            margin-top: 0.5rem;
        }

        .search-container input {
            flex: 1;
            padding: 0.95rem 1rem 0.95rem 3rem;
            font-size: 1rem;
            background: var(--card);
            color: var(--text);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            transition: border 0.25s, box-shadow 0.25s, background 0.3s ease, color 0.3s ease;
        }

        .search-container input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(250, 204, 21, 0.3);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-1);
            transition: color 0.3s ease;
        }

        /* Button styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.45rem;
            padding: 0.9rem 1.35rem;
            border-radius: var(--radius);
            background: var(--primary-1);
            color: #fff;
            font-weight: 600;
            transition: all 0.25s ease, background 0.3s ease, color 0.3s ease;
            white-space: nowrap;
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-1);
            color: var(--primary-1);
            box-shadow: none;
        }

        .btn-outline:hover {
            background: var(--primary-1);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-icon {
            padding: 0.8rem;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            justify-content: center;
        }
        
        /* Header Profile Button */
        #dashboardButton.btn-icon {
            padding: 2px; /* MODIFIED: Creates space for the border */
            overflow: hidden;
            border: 2px solid var(--primary-2);
            background-color: var(--card);
            width: 52px;
            height: 52px;
        }
        
        #headerProfilePic {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%; /* MODIFIED: Makes the image inside circular */
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background: var(--accent-2);
        }

        /* Page layout */
        .page {
            display: none;
            padding: 2rem;
            max-width: 1300px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page.active {
            display: block;
        }
        
        /* Dashboard Page Styles */
        #dashboardPage {
            --dash-grad-1: #8E2DE2;
            --dash-grad-2: #4A00E0;
            --dash-grad-3: #11998e;
            --dash-grad-4: #38ef7d;
            --dash-grad-5: #f2709c;
            --dash-grad-6: #ff9472;
            --dash-text-light: #f0f0f0;
        }
        
        [data-theme="dark"] #dashboardPage {
            --dash-grad-1: #4e54c8;
            --dash-grad-2: #8f94fb;
            --dash-grad-3: #00467F;
            --dash-grad-4: #A5CC82;
            --dash-grad-5: #5614B0;
            --dash-grad-6: #dbd65c;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 2.5rem;
        }
        
        .dashboard-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-1);
            margin-bottom: 0.5rem;
        }
        
        .dashboard-header p {
            font-size: 1.1rem;
            color: var(--text);
            opacity: 0.8;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .profile-card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            grid-column: 1 / -1; /* Span full width on larger screens */
        }
        
        @media (min-width: 768px) {
            .profile-card {
                flex-direction: row;
            }
        }
        
        .profile-picture-wrapper {
            position: relative;
            cursor: pointer;
        }
        
        #profilePicture {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid;
            border-image: linear-gradient(45deg, var(--dash-grad-1), var(--dash-grad-2)) 1;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .profile-picture-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0,0,0,0.5);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .profile-picture-wrapper:hover .profile-picture-overlay {
            opacity: 1;
        }
        
        .profile-info {
            text-align: center;
            flex-grow: 1;
        }
        
        @media (min-width: 768px) {
             .profile-info {
                text-align: right;
            }
        }
        
        .profile-info h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text);
        }

        .goal-card {
            border-radius: var(--radius);
            padding: 2rem;
            color: var(--dash-text-light);
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            transition: transform 0.3s ease;
        }
        
        .goal-card:hover {
            transform: translateY(-5px);
        }
        
        .goal-card.dream-card {
            background: linear-gradient(45deg, var(--dash-grad-3), var(--dash-grad-4));
        }
        
        .goal-card.grade-card {
            background: linear-gradient(45deg, var(--dash-grad-5), var(--dash-grad-6));
        }
        
        .goal-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding-bottom: 1rem;
        }
        
        .goal-card-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .goal-card input {
            background: transparent;
            border: none;
            border-bottom: 2px solid rgba(255,255,255,0.5);
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 0.5rem;
            width: 100%;
            text-align: center;
            font-family: 'Tajawal', sans-serif;
        }
        
        .goal-card input::placeholder {
            color: rgba(255,255,255,0.6);
            font-weight: normal;
        }
        
        .goal-card input:focus {
            outline: none;
            border-bottom-color: white;
        }
        
        .dashboard-save-btn {
            background: var(--accent);
            color: var(--text);
            width: 100%;
            padding: 1rem;
            font-size: 1.2rem;
            border-radius: var(--radius);
            margin-top: 1rem;
            box-shadow: var(--shadow-md);
        }
        
        .dashboard-save-btn:hover {
            background: var(--accent-2);
        }

        /* Category grid */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.8rem;
            margin-top: 1.5rem;
        }

        /* NEW Category Card Styles */
        .category-card {
            border: none;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 240px;
            position: relative;
            overflow: hidden;
            color: white;
            box-shadow: var(--shadow-lg);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: var(--gradient);
            background-size: cover;
            z-index: 1;
            transition: transform 0.4s ease;
        }

        .category-card:hover::before {
            transform: scale(1.05);
        }
        
        .category-card:hover {
             transform: translateY(-8px);
             box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2), 0 10px 10px -5px rgba(0,0,0,0.1);
        }

        .category-icon, .category-content {
            position: relative;
            z-index: 2;
        }
        
        .category-icon {
            text-align: left;
            opacity: 0.7;
        }

        .category-content {
            padding: 0;
            text-align: right;
            background: linear-gradient(to top, rgba(0,0,0,0.6), transparent);
            margin: -1.5rem;
            padding: 3rem 1.5rem 1.5rem 1.5rem;
        }

        .category-title {
            color: white;
            font-size: 1.8rem;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
            margin-bottom: 0.25rem;
        }

        .category-description {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 1rem;
        }

        .category-card .btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(5px);
            color: white;
            align-self: flex-start;
        }
        
        .category-card:hover .btn {
            background: rgba(255, 255, 255, 0.3);
        }


        /* Teachers grid */
        .teachers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.8rem;
            margin-top: 1.5rem;
        }

        .teacher-card {
            background: var(--card);
            padding: 1.4rem 1.1rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.25s ease, box-shadow 0.25s ease, background 0.3s ease, border-color 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .teacher-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 1rem;
            border: 3px solid var(--accent);
            box-shadow: var(--shadow-sm);
            transition: border-color 0.3s ease;
        }

        .teacher-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-1);
            transition: color 0.3s ease;
        }

        .teacher-subject {
            color: var(--text);
            font-size: 0.92rem;
            margin-bottom: 0.5rem;
            opacity: 0.7;
            transition: color 0.3s ease;
        }

        .teacher-rating {
            display: flex;
            justify-content: center;
            gap: 0.2rem;
            margin: 0.5rem 0;
        }

        .teacher-rating .star {
            color: #ddd;
            font-size: 1.1rem;
        }

        .teacher-rating .star.filled {
            color: var(--warning);
        }

        .back-button {
            margin-bottom: 1.5rem;
            background: var(--primary-2);
            box-shadow: var(--shadow-sm);
        }

        .teacher-info {
            display: flex;
            align-items: center;
            gap: 1.4rem;
            background: var(--card);
            padding: 1.6rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-md);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .teacher-img-lg {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--accent);
            box-shadow: var(--shadow-md);
            transition: border-color 0.3s ease;
        }

        .classes-list {
            display: grid;
            gap: 1.4rem;
        }

        .class-card {
            background: var(--card);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.1rem 1.3rem;
            cursor: pointer;
            user-select: none;
            background: var(--bg-glass);
            backdrop-filter: blur(8px);
            border-right: 4px solid var(--primary-2);
            transition: background 0.25s ease, border-color 0.3s ease;
        }
        
        .class-header-content {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .class-progress {
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
        }

        .class-header:hover {
            background: var(--hover);
        }

        .class-header .chevron-icon {
            transition: transform 0.25s ease;
        }

        .class-header.open .chevron-icon {
            transform: rotate(180deg);
        }

        .lectures-list {
            display: none;
            flex-direction: column;
            gap: 0.7rem;
            padding: 1.1rem 1.5rem 0.9rem 0;
        }

        .lecture-item {
            position: relative;
            background: var(--hover);
            border-right: 3px solid var(--primary-3);
            border-radius: var(--radius);
            transition: all 0.25s ease, background 0.3s ease, border-color 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.9rem 1.1rem;
        }
        
        .lecture-item.completed {
            background-color: #dcfce7; /* Light green for completed */
            border-right-color: var(--success);
        }
        
        [data-theme="dark"] .lecture-item.completed {
             background-color: #164e3b; /* Dark green for completed */
        }

        .lecture-item:hover {
            background: rgba(0, 0, 0, 0.08);
        }
        
        .lecture-play-area {
             display: flex;
             align-items: center;
             gap: 0.75rem;
             flex-grow: 1;
             cursor: pointer;
        }

        .lecture-play-area i {
            color: var(--primary-1);
            transition: color 0.3s ease;
        }
        
        /* Completion Checkbox Styles */
        .completion-checkbox {
            position: relative;
            width: 24px;
            height: 24px;
            cursor: pointer;
            margin-left: 1rem; /* Spacing from play button */
        }

        .completion-checkbox input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 24px;
            width: 24px;
            background-color: var(--bg);
            border: 2px solid var(--border);
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .completion-checkbox:hover input ~ .checkmark {
            background-color: var(--hover);
        }

        .completion-checkbox input:checked ~ .checkmark {
            background-color: var(--success);
            border-color: var(--success);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .completion-checkbox input:checked ~ .checkmark:after {
            display: block;
        }

        .completion-checkbox .checkmark:after {
            left: 7px;
            top: 3px;
            width: 6px;
            height: 12px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }

        /* Star Burst Animation */
        .star-burst {
            position: absolute;
            top: 50%;
            left: 12px; /* Centered on the checkbox */
            width: 1px;
            height: 1px;
            pointer-events: none; /* Allows clicking through */
        }

        .star-burst.animate .star-particle {
            animation: burst 0.6s ease-out forwards;
        }

        .star-particle {
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 6px;
            background: var(--accent);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            opacity: 0;
        }

        @keyframes burst {
            0% {
                transform: scale(0.5) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(90deg) translate(var(--translateX), var(--translateY));
                opacity: 0;
            }
        }


        /* Video Page Layout */
        #videoPage.page.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 85px);
            padding: 2rem;
            padding-bottom: 10vh;
        }

        .video-page {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 1000px; /* Constrained width for larger screens */
            width: 100%;
            margin: 0 auto;
            padding: 0;
        }

        .video-container {
            position: relative;
            width: 100%;
            background: #000;
            border-radius: var(--radius); /* Rounded corners for larger screens */
            overflow: hidden;
            aspect-ratio: 16/9;
            box-shadow: var(--shadow-lg); /* Shadow for larger screens */
        }

        .plyr {
            border-radius: var(--radius);
            overflow: hidden;
            width: 100%;
            height: 100%;
        }

        .video-details {
            background: var(--card);
            padding: 1.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .video-info {
            text-align: right;
            padding: 1rem 0;
        }

        .video-meta {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
            opacity: 0.8;
            font-size: 0.9rem;
            flex-wrap: wrap;
            color: var(--text);
        }

        .video-meta span {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 1.5rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-1);
            color: var(--primary-1);
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        /* Smart Loader for iframe videos */
        .video-loader {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            border-radius: var(--radius);
            transition: opacity 0.3s ease;
        }
        
        /* Iframe placeholder styles */
        .iframe-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: inherit;
        }

        .play-button-overlay {
            color: white;
            opacity: 0.8;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .iframe-placeholder:hover .play-button-overlay {
            opacity: 1;
            transform: scale(1.1);
        }


        .loader-spinner {
            border: 6px solid #f3f3f3;
            border-top: 6px solid var(--primary-1);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--modal-bg-start), var(--modal-bg-end));
            border-radius: var(--radius);
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            max-width: 550px;
            width: 90%;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease, background 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 1rem;
        }

        .modal-title {
            font-size: 2rem;
            color: var(--modal-text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            font-weight: 700;
        }

        .modal-body p {
            font-size: 1.2rem;
            color: var(--modal-text-color);
            margin-bottom: 2.5rem;
            line-height: 1.8;
            font-weight: 500;
        }

        .btn-telegram {
            background: linear-gradient(45deg, var(--modal-button-gradient-start), var(--modal-button-gradient-end));
            color: var(--modal-button-text);
            padding: 1.2rem 2.5rem;
            font-size: 1.2rem;
            margin-bottom: 1.2rem;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            border-radius: var(--radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-telegram:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .btn-outline-white {
            background: transparent;
            color: var(--modal-outline-button-text);
            border: 2px solid var(--modal-outline-button-border);
            font-size: 1.1rem;
            padding: 1rem 2rem;
            margin-top: 1rem;
            border-radius: var(--radius);
            transition: all 0.2s ease;
        }

        .btn-outline-white:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Continue Watching Modal styles */
        .continue-modal-content {
            background: linear-gradient(135deg, var(--continue-modal-bg-start), var(--continue-modal-bg-end));
        }

        .continue-modal-content .modal-title {
            color: var(--continue-modal-text);
        }

        .continue-modal-content .modal-body p {
            color: var(--continue-modal-text);
        }
        
        #continueBtn {
            background: var(--continue-button-bg);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            transition: all 0.2s ease;
        }

        #continueBtn:hover {
            background: var(--continue-button-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        #continueBtn .sparkle {
            animation: sparkle-glow 1s ease-in-out infinite alternate;
        }
        
        @keyframes sparkle-glow {
            from {
                filter: drop-shadow(0 0 4px var(--highlight-color));
            }
            to {
                filter: drop-shadow(0 0 10px var(--highlight-color));
            }
        }
        
        #startOverBtn {
            background: transparent;
            color: var(--continue-outline-button-text);
            border: 2px solid var(--continue-outline-button-border);
            padding: 0.8rem 1.5rem;
            border-radius: var(--radius);
            margin-top: 1rem;
            transition: all 0.2s ease;
        }

        #startOverBtn:hover {
            background: rgba(0, 200, 150, 0.2);
            transform: translateY(-2px);
        }

        /* Utility classes */
        .text-center { text-align: center; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .text-lg { font-size: 1.125rem; }
        .font-bold { font-weight: 700; }
        .text-primary-1 { color: var(--primary-1); }
        .flex { display: flex; }
        .justify-center { justify-content: center; }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 0.5rem;
            }
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            .search-container {
                order: 3;
                width: 100%;
            }
            .site-title {
                width: 100%;
                justify-content: center;
                margin-bottom: 0.5rem;
            }
            .teacher-info {
                flex-direction: column;
                text-align: center;
            }
            .video-page {
                padding: 0.5rem;
            }
            .modal-content {
                width: 95%;
            }
            .modal-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="#" onclick="navigate('home')" class="site-title">
            <div class="site-logo">E</div>
            <span>منصة اديسون</span>
        </a>
        <div class="header-actions">
            <button id="themeToggle" class="btn-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-moon">
                    <path d="M12 21a9 9 0 0 1-9-9c0-5.053 3.498-9.397 8.423-10.741a4 4 0 1 1 5.955 5.644c-3.132 1.503-4.593 4.298-5.378 7.317a8.91 8.91 0 0 1-.99 2.52Z" />
                </svg>
            </button>
            <button id="dashboardButton" class="btn-icon">
                <img id="headerProfilePic" src="https://via.placeholder.com/150/d2d6dc" alt="Profile Picture">
            </button>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="ابحث عن مدرس، مادة...">
            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8" />
                <path d="m21 21-4.3-4.3" />
            </svg>
        </div>
    </header>

        <main>
        <div id="homePage" class="page active">
            <div class="categories-grid" id="categoriesGrid"></div>
        </div>

        <div id="teachersPage" class="page">
            <button class="btn back-button" onclick="navigate('home')">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m15 18-6-6 6-6" />
                </svg>
                الرجوع
            </button>
            <div class="teachers-grid" id="teachersGrid"></div>
        </div>
        
        <div id="classesPage" class="page">
            <div class="classes-page">
                <button class="btn back-button" onclick="navigate('teachers')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m15 18-6-6 6-6" />
                    </svg>
                    الرجوع للمدرسين
                </button>
                <div class="teacher-info">
                    <img id="teacherImage" class="teacher-img-lg" alt="صورة المدرس" src="https://via.placeholder.com/150/d2d6dc">
                    <div>
                        <h2 id="teacherName"></h2>
                        <p id="teacherSubject"></p>
                    </div>
                </div>
                <div class="classes-list" id="classesList"></div>
            </div>
        </div>

        <div id="videoPage" class="page">
            <div class="video-page">
                <div class="video-container">
                    <video id="player" playsinline controls></video>
                </div>
                <div class="video-details">
                    <h2 id="videoTitle"></h2>
                    <p id="videoDescription"></p>
                    <button class="btn back-button" onclick="navigate('classes')">
                        العودة للفصول
                    </button>
                </div>
            </div>
        </div>
        
        <div id="dashboardPage" class="page">
            <div class="dashboard-header">
                <h1 class="text-primary-1">لوحة التحكم</h1>
                <p class="text-lg">مرحبًا بك، <span id="userName"></span>!</p>
            </div>
            <div class="dashboard-grid">
                <div class="profile-card">
                    <div class="profile-picture-wrapper">
                        <img id="profilePicture" src="https://via.placeholder.com/150/d2d6dc" alt="صورة الملف الشخصي">
                        <div class="profile-picture-overlay">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14.5 4h.5a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5l-2-2h-3a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h8a4 4 0 0 0 4-4V6a4 4 0 0 0-4-4h-3L14.5 4z" />
                                <path d="M16 11l-4 4-4-4" />
                                <path d="M12 15V3" />
                            </svg>
                        </div>
                    </div>
                    <div class="profile-info">
                        <h2 id="profileName"></h2>
                        <p id="profileEmail" class="text-lg opacity-80"></p>
                    </div>
                </div>
                <div class="goal-card dream-card">
                    <div class="goal-card-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12.5 17h4.94L12.5 7.82V17z" />
                            <path d="M2 12a10 10 0 0 1 10-10c.8 0 1.5.174 2.2.493" />
                            <path d="M12 22a10 10 0 0 0 10-10" />
                            <path d="M2 12a10 10 0 0 0 10 10" />
                            <path d="M22 12A10 10 0 0 0 12 2" />
                            <path d="M8 12a4 4 0 1 1 8 0 4 4 0 0 1-8 0z" />
                        </svg>
                        <h3>هدفي الجامعي</h3>
                    </div>
                    <input type="text" id="dreamGoal" placeholder="اكتب اسم الجامعة أو القسم">
                </div>
                <div class="goal-card grade-card">
                    <div class="goal-card-header">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16z" />
                            <path d="M12 12v6" />
                            <path d="M12 12a4 4 0 0 0-4-4" />
                        </svg>
                        <h3>معدلي المستهدف</h3>
                    </div>
                    <input type="text" id="gradeGoal" placeholder="95">
                </div>
                <button id="saveGoals" class="btn dashboard-save-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 12a10 10 0 1 0 20 0 10 10 0 0 0-20 0z" />
                        <path d="m9 12 2 2 4-4" />
                    </svg>
                    حفظ
                </button>
            </div>
        </div>
    </main>

        <div id="telegramModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 4s-2 2-2 10 2 10 2 10-8-2-10-2-10 2-10 2 2-10 2-10-2-2-2-10-2-10 10-10 10 2 10 2z" />
                        <path d="M12 12s-2-2-2-2-2 2-2 2-2-2-2-2" />
                    </svg>
                    انضم لقناتنا على التليجرام
                </h3>
            </div>
            <div class="modal-body">
                <p>احصل على آخر التحديثات والمحتوى الحصري مباشرة على جهازك</p>
                <a href="https://t.me/sads86ff" target="_blank" class="btn btn-telegram">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 4s-2 2-2 10 2 10 2 10-8-2-10-2-10 2-10 2 2-10 2-10-2-2-2-10-2-10 10-10 10 2 10 2z" />
                    </svg>
                    انضم الآن
                </a>
                <button class="btn btn-outline-white" onclick="closeModal()">لاحقاً</button>
            </div>
        </div>
    </div>

    <div id="continueModal" class="modal">
        <div class="modal-content continue-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m2 12 5.23-5.23" />
                        <path d="M17.84 5.37a2.93 2.93 0 1 1 4.15 4.15l-8.58 8.58a3 3 0 0 1-1.07.72H3v-1.72l9.28-9.28a2.93 2.93 0 0 1 4.15-4.15z" />
                    </svg>
                    متابعة المشاهدة
                </h3>
            </div>
            <div class="modal-body">
                <p>هل تريد متابعة المشاهدة من حيث توقفت؟</p>
                <button id="continueBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play">
                        <polygon points="5 3 19 12 5 21 5 3" />
                    </svg>
                    نعم، تابع من <span id="continueTime">00:00</span>
                </button>
                <button id="startOverBtn">بدء من جديد</button>
            </div>
        </div>
    </div>

    <script type="text/babel">
        // Data structure for the application
        var categories = [];
        var teachers = [];
        var currentTeacher = null;
        var currentClassIndex = 0;
        var currentLectureIndex = 0;
        var currentLectureLink = '';
        var currentIframe = null;
        var videoPlaybackData = JSON.parse(localStorage.getItem('videoPlaybackData') || '{}');
        var userProfile = JSON.parse(localStorage.getItem('userProfile') || '{}');

        // Theme management
        function initializeTheme() {
            var stored = localStorage.getItem('theme');
            var theme = stored || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
            document.documentElement.setAttribute('data-theme', theme);
        }
        initializeTheme();
        document.getElementById('themeToggle').addEventListener('click', function() {
            var cur = document.documentElement.getAttribute('data-theme');
            var next = cur === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            lucide.createIcons();
        });
        lucide.createIcons();
        
        // User Data & Goals
        function loadUserProfile() {
            var profile = JSON.parse(localStorage.getItem('userProfile')) || { name: 'زائر', dream: '', grade: '' };
            document.getElementById('userName').textContent = profile.name;
            document.getElementById('profileName').textContent = profile.name;
            document.getElementById('dreamGoal').value = profile.dream;
            document.getElementById('gradeGoal').value = profile.grade;
        }

        function saveUserProfile() {
            userProfile.name = document.getElementById('profileName').value || 'زائر';
            userProfile.dream = document.getElementById('dreamGoal').value;
            userProfile.grade = document.getElementById('gradeGoal').value;
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            alert('تم حفظ الأهداف بنجاح!');
        }

        document.getElementById('saveGoals').addEventListener('click', saveUserProfile);

        // Page navigation
        var pages = {
            home: document.getElementById('homePage'),
            teachers: document.getElementById('teachersPage'),
            classes: document.getElementById('classesPage'),
            video: document.getElementById('videoPage'),
            dashboard: document.getElementById('dashboardPage')
        };
        
        function navigate(page, data = null) {
            window.scrollTo(0, 0);
            if (page !== 'video' && player) {
                player.pause();
                if (hls) {
                    hls.destroy();
                    hls = null;
                }
            }
            for (let key in pages) {
                pages[key].classList.remove('active');
            }
            pages[page].classList.add('active');
            if (page === 'dashboard') loadUserProfile();
            if (page === 'teachers') renderTeachers(data);
        }
        
        document.getElementById('dashboardButton').onclick = () => navigate('dashboard');

        // Video player and HLS integration (from platform 6)
        var hls;
        var player = new Plyr('#player', {
            controls: ['play-large', 'rewind', 'play', 'fast-forward', 'progress', 'current-time', 'mute', 'volume', 'captions', 'settings', 'airplay', 'fullscreen'],
            settings: ['speed', 'quality'],
            speed: { selected: 1, options: [0.5, 1, 1.25, 1.5, 2] },
            seekTime: 10
        });

        function playVideo(ci, li, url, title, desc) {
            currentClassIndex = ci;
            currentLectureIndex = li;
            currentLectureLink = url;

            var video = document.getElementById('player');
            if (url.endsWith('.m3u8')) {
                if (hls) hls.destroy();
                if (Hls.isSupported()) {
                    hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        player.play();
                    });
                } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = url;
                    video.addEventListener('loadedmetadata', function() {
                        player.play();
                    });
                } else {
                    alert('هذا المتصفح لا يدعم بث الفيديو بهذا الصيغة');
                    return;
                }
            } else {
                player.source = { type: 'video', sources: [{ src: url, type: 'video/mp4' }] };
                player.play();
            }
            document.getElementById('videoTitle').textContent = title;
            document.getElementById('videoDescription').textContent = desc;
            navigate('video');
        }

        // Logic for lecture completion and auto-next (from platform 6)
        var completedLectures = JSON.parse(localStorage.getItem('completedLectures') || '{}');
        function saveCompleted() {
            localStorage.setItem('completedLectures', JSON.stringify(completedLectures));
        }
        
        function markLectureCompleted(url) {
            if (!completedLectures[url]) {
                completedLectures[url] = true;
                saveCompleted();
                if (currentTeacher) renderClasses(currentTeacher.classes);
            }
        }

        player.on('ended', function() {
            markLectureCompleted(currentLectureLink);
            var cls = currentTeacher.classes;
            var ci = currentClassIndex;
            var li = currentLectureIndex;
            if (li < cls[ci].lectures.length - 1) {
                li++;
            } else if (ci < cls.length - 1) {
                ci++;
                li = 0;
            } else return;
            var next = cls[ci].lectures[li];
            playVideo(ci, li, next.url, next.title, next.description);
        });


        // Existing logic from Edison platform
        var teachersGrid = document.getElementById('teachersGrid');
        var searchInput = document.getElementById('searchInput');
        var categoriesGrid = document.getElementById('categoriesGrid');
        var currentCategory = null;
        
        function renderCategories(list) {
            categoriesGrid.innerHTML = list.map(c => `
                <a href="#" class="category-card" onclick="showTeachersByCategory('${c.id}')" style="--gradient: linear-gradient(135deg, ${c.colors[0]}, ${c.colors[1]});">
                    <div class="category-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${c.icon}</svg>
                    </div>
                    <div class="category-content">
                        <h3 class="category-title">${c.name}</h3>
                        <p class="category-description">${c.description}</p>
                        <button class="btn">اذهب للمدرسين</button>
                    </div>
                </a>
            `).join('');
            lucide.createIcons();
        }

        function showTeachersByCategory(id) {
            currentCategory = categories.find(c => c.id === id);
            const filteredTeachers = teachers.filter(t => t.category_id === id);
            navigate('teachers', filteredTeachers);
        }

        function renderTeachers(list) {
            list = list || teachers;
            if (!list.length) {
                teachersGrid.innerHTML = '<p class="text-center mt-4 text-lg">لا يوجد مدرسين في هذا القسم حاليًا.</p>';
                return;
            }
            teachersGrid.innerHTML = list.map(t => `
                <div class="teacher-card" onclick="showTeacher('${t.id}')">
                    <img src="${t.image}" alt="${t.name}" class="teacher-img">
                    <h3 class="teacher-name">${t.name}</h3>
                    <p class="teacher-subject">${t.subject}</p>
                </div>
            `).join('');
        }
        
        function showTeacher(id) {
            currentTeacher = teachers.find(t => t.id === id);
            if (!currentTeacher) return;
            document.getElementById('teacherImage').src = currentTeacher.image;
            document.getElementById('teacherName').textContent = currentTeacher.name;
            document.getElementById('teacherSubject').textContent = currentTeacher.subject;
            renderClasses(currentTeacher.classes);
            navigate('classes');
        }

        function renderClasses(classesData) {
            document.getElementById('classesList').innerHTML = classesData.map((cls, ci) => {
                const totalLectures = cls.lectures.length;
                const completedCount = cls.lectures.filter(lec => completedLectures[lec.url]).length;
                const progressText = `تم إنجاز ${completedCount} من ${totalLectures} محاضرة`;
                const lectures = cls.lectures.map((lec, li) => {
                    const isCompleted = completedLectures[lec.url];
                    return `
                        <div class="lecture-item ${isCompleted ? 'completed' : ''}">
                            <div class="lecture-play-area" onclick="playVideo(${ci}, ${li}, '${lec.url.replace(/'/g, "\\'")}', '${lec.title.replace(/'/g, "\\'")}', '${(lec.description || '').replace(/'/g, "\\'")}')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3" />
                                </svg>
                                <span>${li + 1}. ${lec.title}</span>
                            </div>
                            <label class="completion-checkbox" onclick="event.stopPropagation();">
                                <input type="checkbox" ${isCompleted ? 'checked' : ''} onchange="toggleCompletionStatus('${lec.url.replace(/'/g, "\\'")}', this)">
                                <span class="checkmark"></span>
                                <div class="star-burst"></div>
                            </label>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="class-card">
                        <div class="class-header" onclick="toggleLectures(this)">
                            <div class="class-header-content">
                                <h3>${cls.name}</h3>
                                <span class="class-progress">${progressText}</span>
                            </div>
                            <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m6 9 6 6 6-6" />
                            </svg>
                        </div>
                        <div class="lectures-list">
                            ${lectures}
                        </div>
                    </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        function toggleLectures(el) {
            const list = el.nextElementSibling;
            if (list.style.display === 'flex') {
                list.style.display = 'none';
                el.classList.remove('open');
            } else {
                list.style.display = 'flex';
                el.classList.add('open');
            }
        }

        function toggleCompletionStatus(url, checkbox) {
            if (checkbox.checked) {
                completedLectures[url] = true;
            } else {
                delete completedLectures[url];
            }
            saveCompleted();
            if (currentTeacher) renderClasses(currentTeacher.classes);
        }


        function handleSearch() {
            const term = searchInput.value.trim().toLowerCase();
            const filteredTeachers = teachers.filter(t => t.name.toLowerCase().includes(term) || t.subject.toLowerCase().includes(term));
            renderTeachers(filteredTeachers);
            navigate('teachers', filteredTeachers);
        }
        var searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(handleSearch, 300);
        });
        
        function loadData() {
            fetch('data.json')
                .then(res => {
                    if (!res.ok) throw new Error('فشل تحميل البيانات');
                    return res.json();
                })
                .then(data => {
                    categories = data.categories;
                    teachers = data.teachers;
                    renderCategories(categories);
                })
                .catch(error => console.error('Error:', error));
        }
        
        function closeModal() {
            document.getElementById('telegramModal').classList.remove('show');
            document.getElementById('continueModal').classList.remove('show');
        }
        
        // Initial load
        loadData();
    </script>
</body>
</html>
